---
title: "q2"
author: "Daria Moiseeva 12619364"
date: "2023-10-28"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r reading data, include=FALSE}
library(readxl)
data <- read_xlsx("MUE.2022.for.LMU.xlsx")

library(dplyr)
library(tidyr)
library(tibble)
library(ggplot2)
```

```{r  data}
data.Q2.A <- data %>%
  select(SERIAL,class,C001_01,C001_02,C001_03) %>%
  pivot_longer(cols=c("C001_01","C001_02","C001_03"),
               names_to = "type",
               values_to="frequency")%>%
  group_by(class,type)%>%
  count(frequency) %>%
  group_by(class,type)%>%
  mutate(number_corps=sum(n))%>%
  mutate(percent=n/number_corps)%>%
  filter(frequency >= 1)

data.Q2.A

ggplot(data.Q2.A,aes(x = factor(class, levels = c("Kleine Unternehmen","Mittlere Unternehmen","Gro√üunternehmen"),labels = c("Small","Middle","Big")),y = percent, fill = factor(frequency))) +
  geom_col(position ="dodge") +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  labs(x = "Size of organisation", y = "Percent of organisations engaged", 
       title = "Frequency of corporate volunteering activities
in relationship to the size of a company") +
  scale_fill_discrete(name ="Frequency of engagement :",labels = c("At no time","In particular cases","Regular"))
```




