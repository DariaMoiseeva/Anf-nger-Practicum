---
title: "Untitled"
author: "Tangqian Zhou 12626391"
date: "2023-10-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```
```{r}
library(readxl)
library(dplyr)
data<-read_excel("MUE.2022.for.LMU.xlsx")
data
data$E001<-as.character(data$E001)
data$E001 <- case_when(
  data$E001 == 1 ~ "weniger als 25%",
  data$E001 == 2 ~ "25-49%",
  data$E001 == 3 ~ "50-74%",
  data$E001 == 4 ~ "75% und mehr",
  data$E001 == -1 ~ "Weiss nicht",
  data$E001 == -9 ~ "nicht beantwortet",
  TRUE ~ "Other"
  )
service<-subset(data,A003 %in% c(1,3,8,9,10,11,14,18,19))
service
manufacturing<-subset(data,A003 %in% c(2,4,5,6,7,16,17,20))
manufacturing
all_categories <- data.frame(E001 = factor(c("nicht beantwortet","Weiss nicht","weniger als 25%", "25-49%", "50-74%", "75% und mehr"),levels=c("nicht beantwortet","Weiss nicht","weniger als 25%", "25-49%", "50-74%", "75% und mehr")))
all_categories
service_counts <- table(service$E001)
service_counts
manufacturing_counts <- table(manufacturing$E001)
manufacturing_counts
all_service_counts <- merge(all_categories, data.frame(E001 = names(service_counts), Count = as.numeric(service_counts)))
all_service_counts
all_manufacturing_counts <- merge(all_categories, data.frame(E001 = names(manufacturing_counts), Count = as.numeric(manufacturing_counts)))
all_manufacturing_counts
all_service_counts$E001<-factor(all_service_counts$E001,levels = c("nicht beantwortet","Weiss nicht","weniger als 25%", "25-49%", "50-74%", "75% und mehr"))
all_manufacturing_counts$E001<-factor(all_manufacturing_counts$E001,levels = c("nicht beantwortet","Weiss nicht","weniger als 25%", "25-49%", "50-74%", "75% und mehr"))
all_categories$E001<-factor(all_categories$E001,levels = factor_levels)
all_categories$E001
all_service_counts$Count[is.na(all_service_counts$Count)] <- 0
all_service_counts
all_manufacturing_counts$Count[is.na(all_manufacturing_counts$Count)] <- 0
all_manufacturing_counts
n<-nrow(all_service_counts)
new_order<-c(4,5,6,1,2,3)
all_service_counts_new<-all_service_counts[new_order, ]
all_service_counts_new
all_manufacturing_counts_new<-all_manufacturing_counts[new_order, ]
all_manufacturing_counts_new
barplot(rbind(all_service_counts_new$Count, all_manufacturing_counts_new$Count),
        beside = TRUE,
        names.arg =c("nicht beantwortet","Weiss nicht","weniger als 25%", "25-49%", "50-74%", "75% und mehr") ,
        col = c("blue", "green"),
        legend.text = c("Service Industry", "Manufacturing Industry"),
        main = "Difference in the number of engaged employees in the service industry
versus the manufacturing industry",
        xlab = "Number Ranges",
        ylab = "Number of engaged employees"
)
```
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
